# PROJECT KNOWLEDGE BASE

**Generated:** 2026-01-15
**Commit:** 44a1f50
**Branch:** main

## OVERVIEW

Hybrid Rust + TypeScript terminal UI library. Ink (React for CLI) + Napi-RS (Rust bindings) + Bun + Moon monorepo.

## STRUCTURE

```
open-terminal-ui/
├── packages/
│   ├── ui/           # React/Ink terminal components (@openterminal-ui/ui)
│   └── core/         # Rust native module via Napi-RS (@openterminal-ui/core)
├── .github/workflows/  # CI with change detection
├── biome.json          # TS/JS linting (strict: no any, no unused)
├── tsconfig.base.json  # Shared TS config with path mappings
├── clippy.toml         # Rust linting (maximum strictness)
└── moon.yml            # Moon build orchestration
```

## WHERE TO LOOK

| Task | Location | Notes |
|------|----------|-------|
| Add UI component | `packages/ui/src/components/` | Follow existing pattern: Props interface + FC |
| Add Rust function | `packages/core/src/lib.rs` | Use `#[napi]` decorator, rebuild generates types |
| Run demo | `packages/ui/` | `bun run demo` or `bun run editor` |
| Build all | root | `bun run build` or `moon run :build` |
| Lint | root | `bun run lint` (Biome) |

## CODE MAP

### Core Rust Functions (packages/core)

| Function | Purpose | Used By |
|----------|---------|---------|
| `getSystemStatus()` | Simulated server metrics | Dashboard |
| `renderServerView()` | ASCII box rendering | Dashboard |
| `readDir(path)` | Directory listing | FileTree |
| `readFile(path)` | File content | CodeViewer |
| `fuzzyMatch(query, items)` | Fuzzy search | CommandPalette |
| `highlightCode(content, ext)` | Syntax highlighting (ANSI) | CodeViewer |

### UI Components (packages/ui)

| Component | Purpose | Core Dependency |
|-----------|---------|-----------------|
| `Dashboard` | System monitoring | getSystemStatus, renderServerView |
| `FileTree` | Directory browser | readDir |
| `CodeViewer` | Syntax-highlighted file viewer | readFile, highlightCode |
| `CommandPalette` | Fuzzy command search modal | fuzzyMatch |
| `Button` | Interactive button with focus | None |
| `Input` | Text input with label | None (uses ink-text-input) |
| `Title`, `Status`, `Card` | Basic primitives | None |

## CONVENTIONS

### TypeScript (Biome enforced)
- Single quotes, trailing commas, explicit semicolons
- **NO** `any` - use proper types
- **NO** non-null assertions (`!`)
- **NO** unused imports/variables
- Cognitive complexity limit: 15
- Use `type` imports: `import type { X } from 'y'`

### Rust (Clippy maximum strictness)
- `#![deny(clippy::all)]` in lib.rs
- Use `#[napi]` for exported functions
- Use `#[napi(object)]` for exported structs
- Error handling: return `napi::Result<T>` for fallible ops

### Component Patterns (Ink)
- Props interface with explicit types
- Focus state via `isFocused`/`isActive` prop
- Keyboard: `useInput` hook from Ink
- Border style changes for focus indication (single -> double)

## ANTI-PATTERNS (THIS PROJECT)

- **Never** suppress types with `as any`, `@ts-ignore`
- **Never** edit `packages/core/index.js` or `index.d.ts` - auto-generated by Napi-RS
- **Never** commit `.node` binary files
- **Avoid** `console.log` (Biome warns)
- **Avoid** array index keys in React (use unique identifiers when possible)

## COMMANDS

```bash
# Setup
bun install

# Build all packages
bun run build           # or: moon run :build

# Development
bun run demo            # packages/ui demo
bun run editor          # packages/ui editor example

# Linting
bun run lint            # Biome check
bun run lint:fix        # Auto-fix
cargo fmt               # Rust format
cargo clippy            # Rust lint

# Core rebuild (after Rust changes)
cd packages/core && bun run build
```

## NOTES

- **No tests yet** - testing infrastructure not set up
- **Rust builds required** for core changes - `napi build --platform --release`
- **Types auto-generated** - Napi-RS creates `index.d.ts` from Rust structs
- **CI skips unchanged** - uses path-based change detection
- **Bun workspaces** - use `workspace:*` for internal deps
